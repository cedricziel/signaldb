name: Create Plugin Update

# This workflow is designed to be called from the repository root
# via .github/workflows/grafana-plugin-cp-update.yml
on:
  workflow_call:
    secrets:
      token:
        required: false
        description: 'Fine-grained PAT with contents:write and pull-requests:write permissions'

defaults:
  run:
    working-directory: src/grafana-plugin

jobs:
  update:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
      - uses: grafana/plugin-actions/create-plugin-update@main # zizmor: ignore[unpinned-uses] provided by grafana
        with:
          working-directory: src/grafana-plugin
          # Use provided token or fall back to default github token
          # token: ${{ secrets.token }}
